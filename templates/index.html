{% extends "base.html" %}
{% block content %}
<section class="grid-2 gap-6">
  <div class="card card-padded">
    <h2 class="h2 mb-2">Plan Bilgileri</h2>
    <p class="muted mb-4">Ay ve periyot seçin, dosya adını belirleyin; otel iletişim bilgilerini ekleyin.</p>

    <form id="plan-form" class="stack gap-4">
      <div class="grid-2 gap-3">
        <label class="field">
          <span class="label">Dosya Adı</span>
          <input type="text" name="file_name" placeholder="Eylül Planı" required />
        </label>
        <label class="field">
          <span class="label">Ay Seçimi</span>
          <select name="month" required>
            <option value="" disabled selected>Seçin</option>
            <option>Ocak</option><option>Şubat</option><option>Mart</option><option>Nisan</option>
            <option>Mayıs</option><option>Haziran</option><option>Temmuz</option><option>Ağustos</option>
            <option>Eylül</option><option>Ekim</option><option>Kasım</option><option>Aralık</option>
          </select>
        </label>
      </div>

      <div class="grid-2 gap-3">
        <label class="field">
          <span class="label">Kaç günde bir?</span>
          <input type="number" min="1" max="30" name="interval_days" value="1" required />
        </label>
        <label class="field">
          <span class="label">Başlangıç Tarihi</span>
          <input type="date" name="start_date" />
        </label>
      </div>

      <label class="field">
        <span class="label">Otel İletişim Bilgileri</span>
        <textarea name="hotel_contact" rows="3" placeholder="Tel, e-posta, yetkili isim vb."></textarea>
      </label>

      <div>
        <span class="label mb-2 block">Görseller (sürükle-bırak)</span>
        <div id="dropzone" class="dropzone">
          <input id="images" type="file" name="images" accept="image/*" multiple hidden />
          <button class="btn" type="button" id="pick-images">Görsel Seç</button>
          <p class="muted small">Dosyaları buraya sürükleyin ya da “Görsel Seç”e tıklayın.</p>
        </div>
        <div id="thumbs" class="thumbs mt-3"></div>
      </div>

      <div class="flex gap-3 mt-2">
        <button class="btn btn-primary" type="submit">Planı Oluştur</button>
        <button class="btn btn-ghost" type="reset">Temizle</button>
      </div>
    </form>
  </div>

  <div class="card card-padded">
    <h2 class="h2 mb-2">Çıktılar</h2>
    <div id="results" class="stack gap-2">
      <p class="muted">Henüz bir çıktı yok.</p>
    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}
<script>
  window.__PLAN_ENDPOINTS__ = {
    prefer: "/api/plan",   // varsa burayı kullan
    fallback: "/plan"      // yoksa form-post endpoint'i
  };
</script>
{% endblock %}

{% extends "base.html" %}
{% block content %}
<div class="grid-2">
  <section class="card">
    <div class="card-header">Kullanıcı Oluştur</div>
    <div class="card-body">
      <form method="POST" action="/admin/users/create">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
        <div class="form-group">
          <label for="new_username">Kullanıcı Adı</label>
          <input id="new_username" name="username" required>
        </div>
        <div class="form-group">
          <label for="new_password">Parola</label>
          <input id="new_password" name="password" type="password" required>
        </div>
        <div class="form-group">
          <label>Rol</label>
          <div class="radio-row">
            <label><input type="radio" name="role" value="editor" checked> Çalışan</label>
            <label><input type="radio" name="role" value="admin"> Yönetici</label>
          </div>
        </div>
        <button class="btn btn-primary">Ekle</button>
      </form>
    </div>
  </section>

  <section class="card">
    <div class="card-header">Kullanıcılar</div>
    <div class="card-body">
      <table class="table">
        <thead>
          <tr><th>Kullanıcı</th><th>Rol</th><th style="width:1%"></th></tr>
        </thead>
        <tbody>
          {% for u in users %}
          <tr>
            <td>{{ u.username }}</td>
            <td>{{ u.role }}</td>
            <td>
              {% if u.username != request.session.get("user")["username"] %}
              <form method="POST" action="/admin/users/delete" onsubmit="return confirm('Silinsin mi?')">
                <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                <input type="hidden" name="username" value="{{ u.username }}">
                <button class="btn btn-danger btn-sm">Sil</button>
              </form>
              {% else %}
                <span class="muted">Siz</span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
          {% if not users or users|length == 0 %}
          <tr><td colspan="3" class="muted">Kayıt yok</td></tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </section>
</div>
{% endblock %}
